% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/Med_EM_tree.R
\name{Med_EM_tree}
\alias{Med_EM_tree}
\title{EM estimation for heterogeneous mediation with tree-based \eqn{\pi(X)}}
\usage{
Med_EM_tree(
  K = 2L,
  data_model,
  max_iter = 200L,
  tol = 1e-04,
  compute_ci = FALSE,
  sims_ci = 500L,
  verbose = TRUE,
  tree_args = list(minsplit = 20L, cp = 0.01, maxdepth = 5L)
)
}
\arguments{
\item{K}{Integer. Number of mixture components (\code{K >= 2}).}

\item{data_model}{A \code{data.frame} with columns \code{T, X1, X2, M, Y}.}

\item{max_iter}{Integer. Maximum number of EM iterations.}

\item{tol}{Numeric. Convergence tolerance for relative log-likelihood
change and coefficient change.}

\item{compute_ci}{Logical. If \code{TRUE}, perform nonparametric bootstrap.}

\item{sims_ci}{Integer. Number of bootstrap replications.}

\item{verbose}{Logical. If \code{TRUE}, print EM and bootstrap progress.}

\item{tree_args}{A list of arguments passed to the internal
tree-fitting function (e.g. \code{minsplit}, \code{cp},
\code{maxdepth} for \code{rpart}).}
}
\value{
A list extending the output of the internal core EM with:
\describe{
\item{coefs}{Estimated subgroup-specific \code{alpha, beta, gamma}.}
\item{piz}{Estimated mixing proportions \eqn{\hat{\pi}_k(X)}.}
\item{w}{Posterior responsibilities.}
\item{sigma_M}{Component-specific residual standard deviations for \code{M}.}
\item{sigma_Y}{Component-specific residual standard deviations for \code{Y}.}
\item{loglik}{Final log-likelihood.}
\item{pi_model}{Fitted tree model(s) for \eqn{\pi_k(X)}.}
\item{n_iter}{Number of EM iterations used.}
\item{ci}{If \code{compute_ci = TRUE}, a list of length \code{K} with
entries \code{NIE_hat}, \code{NIE_ci}, \code{NDE_hat}, \code{NDE_ci}.}
}
}
\description{
This function estimates a K-component heterogeneous mediation model
using an EM algorithm where the mixing proportions \eqn{\pi_k(X)}
are modeled nonparametrically by a decision tree. Optionally, it
computes nonparametric bootstrap confidence intervals for
subgroup-specific NIE and NDE.
}
\examples{
\donttest{
set.seed(2025)
sim  <- data_generate(200, setting = 1L)
fit  <- Med_EM_tree(
  K          = 2L,
  data_model = sim$data,
  max_iter   = 100,
  tol        = 1e-4,
  compute_ci = FALSE
)
fit$coefs
}

}
